<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>·ä†·à∞·çã ·ã≤·åÇ·â≥·àç ·â¢·äï·åé ·å®·ãã·â≥</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Ethiopic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* MOBILE FIRST DESIGN - OPTIMIZED */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Times New Roman', 'Noto Sans Ethiopic', sans-serif;
            background: linear-gradient(135deg, #0d47a1 0%, #1a237e 100%);
            color: white;
            touch-action: manipulation;
        }

        .amharic-text {
            font-family: 'Noto Sans Ethiopic', 'Times New Roman', sans-serif;
        }

        /* TRIPLE BORDER CONTAINER */
        .border-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 5px;
            background: linear-gradient(45deg, #28a745 0%, #ffd700 33%, #dc3545 66%, #28a745 100%);
            animation: borderGlow 3s infinite alternate;
        }

        .main-container {
            width: 100%;
            height: 100%;
            background: #0d47a1;
            overflow: hidden;
            position: relative;
            border-radius: 8px;
        }

        /* SINGLE PAGE LAYOUT */
        .page-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            overflow: hidden;
        }

        .page-container.active {
            transform: translateX(0);
        }

        /* PAGE BORDERS */
        .page-border {
            position: absolute;
            pointer-events: none;
            border-radius: 8px;
        }

        .page-border.green {
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid #28a745;
            animation: greenPulse 3s infinite;
        }

        .page-border.yellow {
            top: 3px;
            left: 3px;
            right: 3px;
            bottom: 3px;
            border: 2px solid #ffd700;
            animation: yellowPulse 3s infinite;
        }

        .page-border.red {
            top: 6px;
            left: 6px;
            right: 6px;
            bottom: 6px;
            border: 2px solid #dc3545;
            animation: redPulse 3s infinite;
        }

        /* PAGE CONTENT */
        .page-content {
            flex: 1;
            padding: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* FIXED CONTROLS - IMPROVED POSITIONING */
        .fixed-controls {
            position: fixed;
            bottom: 10px;
            left: 10px;
            right: 10px;
            background: rgba(13, 71, 161, 0.95);
            border: 2px solid #ffd700;
            border-radius: 10px;
            padding: 8px;
            z-index: 100;
            display: flex;
            gap: 6px;
            height: 55px;
            align-items: center;
        }

        /* HELP BUTTON */
        .help-circle-btn {
            position: fixed;
            top: 15px;
            right: 15px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #17a2b8;
            color: white;
            border: 2px solid #ffd700;
            font-size: 20px;
            font-weight: bold;
            z-index: 1000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* REGISTRATION TOP BAR */
        .registration-top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 5px;
            margin-bottom: 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #ffd700;
            border-radius: 10px;
            height: 60px;
        }

        .registration-title {
            color: #ffd700;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            flex: 1;
        }

        .top-bar-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid #ffd700;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .win-btn {
            background: #ffd700;
            color: #0d47a1;
        }

        .members-btn {
            background: #28a745;
            color: white;
        }

        /* HELP CONTENT */
        .help-content {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border: 2px solid #ffd700;
            margin-bottom: 10px;
        }

        .help-section {
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border: 1px solid #28a745;
        }

        .help-title {
            color: #ffd700;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            text-align: center;
        }

        .help-text {
            color: white;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 6px;
        }

        /* HELP NAVIGATION */
        .help-nav {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border: 1px solid #ffd700;
            flex-wrap: wrap;
        }

        .help-nav-btn {
            flex: 1;
            min-width: 120px;
            padding: 8px 5px;
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid #ffd700;
            border-radius: 5px;
            color: white;
            font-size: 12px;
            cursor: pointer;
            text-align: center;
        }

        .help-nav-btn.active {
            background: #ffd700;
            color: #0d47a1;
            font-weight: bold;
        }

        .help-tab-content {
            display: none;
        }

        .help-tab-content.active {
            display: block;
        }

        /* MODALS */
        .members-modal, .potential-win-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            display: none;
            overflow-y: auto;
            padding: 15px;
        }

        .modal-content {
            background: #0d47a1;
            border: 3px solid #28a745;
            border-radius: 15px;
            padding: 15px;
            max-width: 500px;
            margin: 0 auto;
        }

        .modal-header {
            color: #ffd700;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ffd700;
        }

        .members-table, .winning-table {
            width: 100%;
            border-collapse: collapse;
        }

        .members-table th, .winning-table th {
            background: #28a745;
            color: white;
            padding: 8px;
            text-align: left;
            font-size: 12px;
            position: sticky;
            top: 0;
            border: 1px solid #ffd700;
        }

        .members-table td, .winning-table td {
            padding: 6px;
            border: 1px solid #ffd700;
            font-size: 11px;
        }

        .member-row:nth-child(even) {
            background: rgba(255, 255, 255, 0.1);
        }

        .member-name {
            font-weight: bold;
            color: #ffd700;
        }

        .member-paid {
            color: #28a745;
            font-weight: bold;
        }

        .member-not-paid {
            color: #dc3545;
        }

        .win-amount {
            color: #28a745;
            font-weight: bold;
            font-size: 14px;
        }

        .current-stake-row {
            background: rgba(255, 215, 0, 0.2) !important;
            font-weight: bold;
        }

        /* BUTTONS */
        .control-btn {
            height: 40px;
            border-radius: 8px;
            border: 2px solid #000;
            font-family: inherit;
            font-size: 14px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 0 10px;
            flex: 1;
            transition: all 0.2s;
            text-transform: uppercase;
            min-width: 0;
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .btn-secondary {
            background: #ffd700;
            color: #0d47a1;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        /* PAGE HEADERS */
        .page-header {
            color: #ffd700;
            font-weight: bold;
            font-size: 18px;
            text-align: center;
            padding: 10px;
            margin-bottom: 10px;
            border: 2px solid #ffd700;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
        }

        /* WELCOME PAGE - REDESIGNED */
        .welcome-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 20px;
            text-align: center;
        }

        .game-title {
            font-size: 22px;
            color: #ffd700;
            text-align: center;
            margin-bottom: 10px;
            font-weight: bold;
            line-height: 1.4;
        }

        .developer-text {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 20px;
            text-align: center;
        }

        .start-btn-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #28a745;
            border: 3px solid #ffd700;
            color: white;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            animation: pulse 2s infinite;
        }

        /* BOARD SELECTION */
        .board-selection-container {
            border: 3px solid #ffd700;
            border-radius: 12px;
            padding: 10px;
            margin: 5px;
            height: calc(100vh - 150px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .board-type-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 8px;
            flex: 1;
            margin: 0;
            padding: 5px;
        }

        .board-type-card {
            background: rgba(0, 0, 0, 0.2);
            border: 2px solid #ffd700;
            border-radius: 10px;
            padding: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 0;
            overflow: hidden;
        }

        .board-type-card.selected {
            background: rgba(255, 215, 0, 0.3);
            border-color: #28a745;
            transform: scale(0.98);
            box-shadow: 0 0 15px rgba(40, 167, 69, 0.5);
        }

        .board-type-icon {
            font-size: 18px;
            margin-bottom: 4px;
        }

        .board-type-title {
            color: #ffd700;
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 2px;
            line-height: 1.2;
        }

        .board-type-desc {
            font-size: 8px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.1;
        }

        /* REGISTRATION FORM */
        .registration-form {
            border: 2px solid #ffd700;
            border-radius: 12px;
            padding: 15px;
            margin: 5px;
            height: calc(100vh - 210px);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .form-scroll {
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #ffd700;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            height: 40px;
            padding: 0 10px;
            border: 2px solid #000;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            color: #333;
            font-weight: bold;
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='black'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 14px;
            padding-right: 30px;
        }

        /* PAYMENT SECTION */
        .payment-section {
            background: rgba(0, 0, 0, 0.2);
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
        }

        .payment-select {
            width: 100%;
            height: 40px;
            border: 2px solid #000;
            border-radius: 8px;
            background: white;
            color: #0d47a1;
            font-size: 14px;
            font-weight: bold;
            padding: 0 10px;
        }

        /* FINANCE PAGE */
        .finance-container {
            border: 2px solid #28a745;
            border-radius: 12px;
            padding: 15px;
            margin: 5px;
            height: calc(100vh - 150px);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .finance-form {
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }

        /* GAME BOARD CONTAINER - IMPROVED POSITIONING */
        .game-board-container {
            position: absolute;
            top: 70px;
            left: 10px;
            right: 10px;
            bottom: 130px;
            border: 3px solid #ffd700;
            border-radius: 12px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.25);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 5px;
        }

        #gameBoard {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* BINGO BOARD LAYOUTS */
        .board-75-wrapper, .board-50-wrapper, .board-pattern-wrapper {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
        }

        .bingo-labels, .board-pattern-labels {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 2px;
            margin-bottom: 2px;
            padding: 2px;
            width: 100%;
            height: 12%;
        }

        .bingo-label, .board-pattern-label {
            background: #ffd700;
            color: #0d47a1;
            border: 2px solid #000;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            width: 100%;
            height: 100%;
        }

        .board-75, .board-50, .board-pattern {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 2px;
            width: 100%;
            height: 88%;
            padding: 2px;
        }

        /* 90-BALL BOARD */
        .board-90-wrapper {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            overflow: hidden;
        }

        .board-90-labels {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 1px;
            margin-bottom: 1px;
            padding: 1px;
            width: 100%;
            height: 10%;
        }

        .board-90-label {
            background: #ffd700;
            color: #0d47a1;
            border: 2px solid #000;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            width: 100%;
            height: 100%;
        }

        .board-90 {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 1px;
            width: 100%;
            height: 90%;
            padding: 1px;
        }

        /* 30-BALL BOARD */
        .board-30-wrapper {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            justify-content: center;
            align-items: center;
        }

        .board-30-labels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 3px;
            margin-bottom: 3px;
            padding: 3px;
            width: 90%;
            height: 15%;
        }

        .board-30-label {
            background: #ffd700;
            color: #0d47a1;
            border: 2px solid #000;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            width: 100%;
            height: 100%;
        }

        .board-30 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 4px;
            width: 90%;
            height: 85%;
            max-width: 90%;
            max-height: 85%;
            padding: 5px;
        }

        /* COVERALL BOARD */
        .board-coverall-wrapper {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            overflow: hidden;
        }

        .board-coverall-labels {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 1px;
            margin-bottom: 1px;
            padding: 1px;
            width: 100%;
            height: 8%;
        }

        .board-coverall-label {
            background: #ffd700;
            color: #0d47a1;
            border: 2px solid #000;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 10px;
            width: 100%;
            height: 100%;
        }

        .board-coverall {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 1px;
            width: 100%;
            height: 92%;
            padding: 1px;
        }

        /* BOARD CELLS */
        .board-cell {
            background: white;
            color: #333;
            border: 2px solid #000;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
            min-height: 0;
            min-width: 0;
            font-family: 'Times New Roman', 'Noto Sans Ethiopic', sans-serif;
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        .board-90 .board-cell {
            font-size: 11px;
        }

        .board-30 .board-cell {
            font-size: 14px;
        }

        .board-coverall .board-cell {
            font-size: 10px;
        }

        .board-cell.marked {
            background: #dc3545;
            color: white;
            transform: scale(0.95);
        }

        .board-cell.pattern-cell {
            background: #ffd700;
            color: #0d47a1;
        }

        /* CENTER CELL */
        .center-cell {
            background: #ff6b6b;
            color: white;
            font-size: 14px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        .center-cell.winner-ready {
            background: #28a745;
            animation: pulseFast 0.5s infinite;
            font-size: 16px;
            box-shadow: 0 0 20px #28a745;
            transform: scale(1.1);
        }

        .center-cell.winner-claimed {
            background: #17a2b8;
            animation: none;
            box-shadow: 0 0 15px #17a2b8;
        }

        .board-cell.blank-cell {
            background: #6c757d;
            color: #ccc;
            cursor: default;
        }

        /* WIN INDICATOR */
        .winner-indicator {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 15px;
            height: 15px;
            background: #28a745;
            color: white;
            border-radius: 50%;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: bounce 1s infinite;
        }

        /* GAME HEADER */
        .game-header {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            height: 45px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #ffd700;
            border-radius: 8px;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 101;
        }

        .game-title-bar {
            color: #ffd700;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
        }

        /* CIRCULAR CALL BUTTON */
        .circular-call-container {
            position: absolute;
            bottom: 70px;
            left: 10px;
            right: 10px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            z-index: 102;
        }

        .circular-call-btn {
            width: 60px;
            height: 60px;
            min-width: 60px;
            border-radius: 50%;
            border: 3px solid #000;
            background: #28a745;
            color: white;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .circular-call-btn.calling {
            background: #dc3545;
            animation: pulseFast 1s infinite;
        }

        #currentNumberDisplay {
            font-size: 22px;
            font-weight: bold;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* CALLED NUMBERS BAR */
        .called-numbers-bar {
            flex: 1;
            height: 50px;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #ffd700;
            border-radius: 8px;
            padding: 0 10px;
            display: flex;
            align-items: center;
            overflow-x: auto;
            white-space: nowrap;
            font-size: 16px;
            font-weight: bold;
            color: #ffd700;
        }

        .called-number {
            margin-right: 8px;
            padding: 5px 8px;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 4px;
            animation: slideIn 0.3s;
            min-width: 55px;
            text-align: center;
            font-family: 'Times New Roman', 'Noto Sans Ethiopic', sans-serif;
        }

        .called-number:first-child {
            background: rgba(40, 167, 69, 0.3);
            border: 1px solid #28a745;
        }

        /* GAME CONTROLS */
        .game-controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            gap: 6px;
        }

        /* WINNER NOTIFICATION */
        .winner-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 20px;
            border-radius: 15px;
            font-size: 24px;
            font-weight: bold;
            z-index: 1000;
            text-align: center;
            border: 5px solid #ffd700;
            width: 90%;
            max-width: 350px;
            display: none;
            animation: slideUp 0.4s;
        }

        /* NOTIFICATION */
        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ffd700;
            z-index: 2001;
            text-align: center;
            max-width: 300px;
            display: none;
        }

        /* CONNECTION STATUS */
        .connection-status {
            position: fixed;
            top: 15px;
            left: 15px;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-connected {
            background: #28a745;
            color: white;
            border: 2px solid #155724;
        }

        .status-disconnected {
            background: #dc3545;
            color: white;
            border: 2px solid #721c24;
        }

        .status-connecting {
            background: #ffc107;
            color: #212529;
            border: 2px solid #856404;
        }

        /* ADMIN PANEL */
        .admin-panel {
            position: fixed;
            bottom: 70px;
            left: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.95);
            border: 3px solid #28a745;
            border-radius: 12px;
            padding: 15px;
            z-index: 1001;
            display: none;
        }

        .admin-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .admin-btn {
            flex: 1;
            min-width: 120px;
            height: 45px;
            border-radius: 8px;
            border: 2px solid #000;
            font-weight: bold;
            cursor: pointer;
        }

        .admin-start {
            background: #28a745;
            color: white;
        }

        .admin-stop {
            background: #dc3545;
            color: white;
        }

        .admin-call {
            background: #ffd700;
            color: #0d47a1;
        }

        .admin-reset {
            background: #17a2b8;
            color: white;
        }

        /* ANIMATIONS */
        @keyframes borderGlow {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        @keyframes greenPulse {
            0%, 100% { border-color: #28a745; }
            50% { border-color: #20c997; }
        }

        @keyframes yellowPulse {
            0%, 100% { border-color: #ffd700; }
            50% { border-color: #ffc107; }
        }

        @keyframes redPulse {
            0%, 100% { border-color: #dc3545; }
            50% { border-color: #ff6b6b; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes pulseFast {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translate(-50%, -40%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 5px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb {
            background: #ffd700;
            border-radius: 3px;
        }

        /* RESPONSIVE ADJUSTMENTS */
        @media (max-width: 320px) {
            .board-type-grid {
                gap: 5px;
                padding: 3px;
            }
            
            .board-type-card {
                padding: 5px;
            }
            
            .board-type-icon {
                font-size: 16px;
            }
            
            .board-type-title {
                font-size: 10px;
            }
            
            .board-type-desc {
                font-size: 8px;
            }
            
            .fixed-controls {
                padding: 6px;
                gap: 4px;
                height: 50px;
            }
            
            .control-btn {
                height: 38px;
                font-size: 12px;
            }
            
            .top-bar-btn {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .registration-form {
                height: calc(100vh - 200px);
            }
            
            .circular-call-btn {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }
            
            #currentNumberDisplay {
                font-size: 18px;
            }
            
            .called-numbers-bar {
                height: 45px;
                font-size: 14px;
                padding: 0 8px;
            }
            
            .called-number {
                font-size: 12px;
                min-width: 50px;
                padding: 4px 6px;
            }
            
            .board-cell {
                font-size: 10px;
            }
        }

        @media (max-height: 600px) {
            .game-board-container {
                top: 50px;
                bottom: 110px;
            }
            
            .circular-call-container {
                bottom: 55px;
            }
            
            .board-selection-container,
            .registration-form,
            .finance-container {
                height: calc(100vh - 140px);
            }
            
            .registration-form {
                height: calc(100vh - 190px);
            }
            
            .board-cell {
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Audio Elements -->
    <audio id="callAudio" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-bell-notification-933.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="winAudio" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" type="audio/mpeg">
    </audio>

    <!-- Connection Status -->
    <div id="connectionStatus" class="connection-status status-disconnected">
        <span id="statusIcon">üî¥</span>
        <span id="statusText" class="amharic-text">·ã®·àö·åà·äì·äù...</span>
    </div>

    <!-- Triple Border Container -->
    <div class="border-container">
        <div class="main-container">
            <!-- Color Borders -->
            <div class="page-border green"></div>
            <div class="page-border yellow"></div>
            <div class="page-border red"></div>

            <!-- Page 0: Welcome -->
            <div class="page-container active" id="page0">
                <button class="help-circle-btn" onclick="showPage(5)">?</button>
                
                <div class="page-content">
                    <div class="welcome-content">
                        <div class="game-title amharic-text">·ä†·à∞·çã ·ã≤·åÇ·â≥·àç ·â¢·äï·åé ·å®·ãã·â≥</div>
                        <div style="font-size: 14px; color: #ffd700; margin-bottom: 30px; text-align: center;">
                            Assefa Gashaye Birhanie Digital Bingo Game (AGBDBG)
                        </div>
                        <button class="start-btn-circle" onclick="showPage(1)">
                            <div style="font-size: 24px;">üéÆ</div>
                        </button>
                        <div class="developer-text amharic-text">·ä†·à∞·çã ·åã·àª·ã¨ ·â•·à≠·àÉ·äï·äê·àÖ</div>
                    </div>
                </div>
            </div>

            <!-- Page 1: Board Selection -->
            <div class="page-container" id="page1">
                <div class="page-content">
                    <div class="page-header amharic-text">·ã®·â¶·à≠·ãµ ·ãì·ã≠·äê·âµ ·ã≠·àù·à®·å°</div>
                    <div class="board-selection-container">
                        <div class="board-type-grid" id="boardTypeGrid"></div>
                    </div>
                </div>
                
                <div class="fixed-controls">
                    <button class="control-btn btn-secondary" onclick="showPage(0)">·â∞·àò·àà·àµ</button>
                    <button class="control-btn btn-success" id="nextBtn">·âÄ·å•·àç</button>
                </div>
            </div>

            <!-- Page 2: Registration -->
            <div class="page-container" id="page2">
                <div class="page-content">
                    <!-- Registration Top Bar -->
                    <div class="registration-top-bar">
                        <button class="top-bar-btn win-btn" onclick="showPotentialWin()">üèÜ</button>
                        <div class="registration-title amharic-text">·àù·ãù·åà·â£</div>
                        <button class="top-bar-btn members-btn" onclick="showMembers()">üë•</button>
                    </div>
                    
                    <div class="registration-form">
                        <div class="form-scroll">
                            <div class="form-group">
                                <label for="playerName" class="amharic-text">·àµ·àù</label>
                                <input type="text" id="playerName" class="form-control" placeholder="·àô·àâ ·àµ·àù">
                            </div>
                            
                            <div class="form-group">
                                <label for="playerPhone" class="amharic-text">·àµ·àç·ä≠</label>
                                <input type="tel" id="playerPhone" class="form-control" placeholder="0918203416">
                            </div>
                            
                            <div class="payment-section">
                                <select id="paymentAmount" class="payment-select" onchange="processPayment()">
                                    <option value="">·ä≠·çç·ã´ ·àò·å†·äï ·ã≠·àù·à®·å°</option>
                                    <option value="25">25 ·â•·à≠</option>
                                    <option value="50">50 ·â•·à≠</option>
                                    <option value="100">100 ·â•·à≠</option>
                                    <option value="200">200 ·â•·à≠</option>
                                    <option value="500">500 ·â•·à≠</option>
                                    <option value="1000">1000 ·â•·à≠</option>
                                    <option value="2000">2000 ·â•·à≠</option>
                                    <option value="5000">5000 ·â•·à≠</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="playerStake" class="amharic-text">·ãç·à≠·à≠·ãµ ·àò·å†·äï</label>
                                <select id="playerStake" class="form-control" onchange="updatePotentialWin()">
                                    <option value="">·ã≠·àù·à®·å°</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="boardSelect" class="amharic-text">·ã®·â¶·à≠·ãµ ·âÅ·å•·à≠</label>
                                <select id="boardSelect" class="form-control">
                                    <option value="">1-100</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="fixed-controls">
                    <button class="control-btn btn-secondary" onclick="showPage(1)">·â∞·àò·àà·àµ</button>
                    <button class="control-btn btn-success" id="confirmBtn">·åÄ·àù·à≠</button>
                </div>
            </div>

            <!-- Page 3: Game Board -->
            <div class="page-container" id="page3">
                <div class="game-header">
                    <div class="game-title-bar amharic-text" id="gameHeader"></div>
                </div>
                
                <div class="game-board-container">
                    <div id="gameBoard"></div>
                </div>
                
                <!-- Circular Call Button -->
                <div class="circular-call-container">
                    <div class="called-numbers-bar" id="calledNumbersBar">
                        <!-- Numbers will be added here -->
                    </div>
                </div>
                
                <!-- Game Controls -->
                <div class="game-controls">
                    <button class="control-btn btn-secondary" onclick="showPage(2)">·â∞·àò·àà·àµ</button>
                    <button class="control-btn btn-info" onclick="showPage(4)">·çã·ã≠·äì·äï·àµ</button>
                    <button class="control-btn btn-success" onclick="announceWin()" id="announceBtn">·ä†·à∏·äì·çä ·äì·àà·àÅ!</button>
                </div>
            </div>

            <!-- Page 4: Finance -->
            <div class="page-container" id="page4">
                <div class="page-content">
                    <div class="page-header amharic-text">·çã·ã≠·äì·äï·àµ</div>
                    
                    <div class="finance-container">
                        <div class="finance-form">
                            <div class="form-group">
                                <label class="amharic-text">·å†·âÖ·àã·àã ·ä≠·çç·ã´</label>
                                <input type="text" id="totalPayment" class="form-control" readonly value="0 ·â•·à≠">
                            </div>
                            
                            <div class="form-group">
                                <label class="amharic-text">·å†·âÖ·àã·àã ·àΩ·àç·àõ·âµ</label>
                                <input type="text" id="totalWon" class="form-control" readonly value="0 ·â•·à≠">
                            </div>
                            
                            <div class="form-group">
                                <label class="amharic-text">·ä†·àÅ·äï ·ã´·àà·ãç</label>
                                <input type="text" id="currentBalance" class="form-control" readonly value="0 ·â•·à≠">
                            </div>
                            
                            <div class="form-group">
                                <label for="withdrawAccount" class="amharic-text">·ã®·ä†·ä´·ãç·äï·âµ ·âÅ·å•·à≠</label>
                                <input type="text" id="withdrawAccount" class="form-control" placeholder="1000062264911">
                            </div>
                            
                            <div class="form-group">
                                <label for="withdrawAmount" class="amharic-text">·àà·àò·ãç·å£·âµ</label>
                                <input type="text" id="withdrawAmount" class="form-control" readonly value="0 ·â•·à≠">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="fixed-controls">
                    <button class="control-btn btn-secondary" onclick="showPage(3)">·â∞·àò·àà·àµ</button>
                    <button class="control-btn btn-success" onclick="processWithdrawal()">·ä†·ãç·å£</button>
                </div>
            </div>

            <!-- Page 5: Detailed Help Information -->
            <div class="page-container" id="page5">
                <div class="page-content">
                    <div class="page-header amharic-text">·ä•·à≠·ã≥·â≥ / Help</div>
                    
                    <!-- Help Navigation -->
                    <div class="help-nav">
                        <button class="help-nav-btn amharic-text active" onclick="showHelpTab('general')">·ä†·å†·âÉ·àã·ã≠</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('rules')">·ã∞·äï·â¶·âΩ</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('75ball')">75-·â¢·äï·åé</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('90ball')">90-·â¢·äï·åé</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('30ball')">30-·â¢·äï·åé</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('50ball')">50-·â¢·äï·åé</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('pattern')">·äï·ãµ·çç ·â¢·äï·åé</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('coverall')">·àô·àâ ·â§·âµ</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('winning')">·ã®·àõ·à∏·äê·çç ·àÇ·ã∞·âµ</button>
                        <button class="help-nav-btn amharic-text" onclick="showHelpTab('payment')">·ä≠·çç·ã´ ·àµ·à≠·ãì·âµ</button>
                    </div>
                    
                    <div class="help-content">
                        <!-- General Tab -->
                        <div class="help-tab-content active" id="help-general">
                            <div class="help-section">
                                <div class="help-title amharic-text">·â¢·äï·åé ·àù·äï·ãµ·äï ·äê·ãç? / What is Bingo?</div>
                                <div class="help-text amharic-text">
                                    ·â¢·äï·åé ·ã®·ä†·åã·å£·àö ·âÅ·å•·àÆ·âΩ·äï ·ã®·àö·å†·âÄ·àù ·å®·ãã·â≥ ·äê·ãç·ç¢ ·âÅ·å•·àÆ·âΩ ·â†·ãò·çà·âÄ·ã∞ ·ã≠·å†·à´·àâ·ç£ ·â∞·å´·ãã·âæ·âΩ ·ã∞·åç·àû ·â†·àò·à≥·â∏·ãç ·à∞·äï·å†·à®·ã• ·àã·ã≠ ·â∞·å†·à≠·â∞·ãç ·ã´·ã©·âµ·äï ·àù·àç·ä≠·âµ ·ã´·ã∞·à≠·åã·àâ·ç¢ ·ä†·äï·ãµ ·äï·ãµ·çç ·àô·àâ ·à≤·àÜ·äï "·â¢·äï·åé" ·â†·àõ·àà·âµ ·ã≠·å†·à´·àâ·ç¢
                                </div>
                                <div class="help-text">
                                    Bingo is a game of chance where numbers are randomly drawn and players mark them on their cards. The first to complete a pattern calls "Bingo" and wins.
                                </div>
                            </div>
                            
                            <div class="help-section">
                                <div class="help-title amharic-text">·ã®·å®·ãã·â≥ ·ä†·ãà·âÉ·âÄ·à≠ / Game Structure</div>
                                <div class="help-text amharic-text">
                                    1. ·ã®·å®·ãã·â≥ ·åà·åΩ 6: ·ã®·â∞·àà·ã´·ã© ·â¶·à≠·ãµ ·ãì·ã≠·äê·â∂·âΩ<br>
                                    2. ·àù·ãù·åà·â£ ·åà·åΩ: ·ã®·â∞·å´·ãã·âΩ ·àò·à®·åÉ ·ä•·äì ·ä≠·çç·ã´<br>
                                    3. ·ã®·å®·ãã·â≥ ·â¶·à≠·ãµ: ·ã®·âÅ·å•·à≠ ·àù·àç·ä≠·âµ ·ä•·äì ·ä†·à∏·äì·çä·äê·âµ<br>
                                    4. ·çã·ã≠·äì·äï·àµ ·åà·åΩ: ·àö·ãõ·äï ·ä•·äì ·ã®·àõ·ãç·å£·âµ ·àÇ·ã∞·âµ<br>
                                    5. ·ä•·à≠·ã≥·â≥ ·åà·åΩ: ·ãù·à≠·ãù·à≠ ·àò·àò·à™·ã´ ·â†·ä†·àõ·à≠·äõ ·ä•·äì ·ä•·äï·åç·àä·ãù·äõ
                                </div>
                                <div class="help-text">
                                    1. Game Page 6: Different board types<br>
                                    2. Registration Page: Player info and payment<br>
                                    3. Game Board: Number marking and winning<br>
                                    4. Finance Page: Balance and withdrawal<br>
                                    5. Help Page: Detailed instructions in Amharic and English
                                </div>
                            </div>
                        </div>
                        
                        <!-- Rules Tab -->
                        <div class="help-tab-content" id="help-rules">
                            <div class="help-section">
                                <div class="help-title amharic-text">·ä†·å†·âÉ·àã·ã≠ ·ã∞·äï·â¶·âΩ / General Rules</div>
                                <div class="help-text amharic-text">
                                    1. ·ä•·ã´·äï·ã≥·äï·ã± ·â∞·å´·ãã·âΩ ·ã®·â¢·äï·åé ·à∞·äï·å†·à®·ã• ·ã≠·åà·ãõ·àç<br>
                                    2. ·âÅ·å•·àÆ·âΩ ·â†·ãò·çà·âÄ·ã∞ ·ã≠·å†·à´·àâ (·àÅ·àà 7 ·à∞·ä®·äï·ãµ)<br>
                                    3. ·ã®·â∞·å†·à´·ãç ·âÅ·å•·à≠ ·â†·à∞·äï·å†·à®·ã•·àÖ ·àã·ã≠ ·ä´·àà ·àù·àç·ä≠·âµ ·ä†·ãµ·à≠·åç<br>
                                    4. ·äï·ãµ·çç ·àô·àâ ·ä®·àÜ·äê "·ä†·à∏·äì·çä ·äì·àà·àÅ!" ·âÅ·àç·çâ·äï ·ã≠·äï·ä©<br>
                                    5. ·àΩ·àç·àõ·âµ ·ã≠·âÄ·â†·àã·àâ
                                </div>
                                <div class="help-text">
                                    1. Each player buys a bingo card<br>
                                    2. Numbers are randomly called (every 7 seconds)<br>
                                    3. Mark called numbers on your card<br>
                                    4. Click "I'm Winner!" button when pattern completes<br>
                                    5. Receive your prize
                                </div>
                            </div>
                            
                            <div class="help-section">
                                <div class="help-title amharic-text">·ã®·âÅ·å•·à≠ ·å•·à™ ·ä†·àò·å£·å• / Calling Logic</div>
                                <div class="help-text amharic-text">
                                    ‚Ä¢ ·âÅ·å•·àÆ·âΩ ·â†·à´·àµ-·à∞·à≠ ·ã≠·å†·à´·àâ (·àÅ·àà 7 ·à∞·ä®·äï·ãµ)<br>
                                    ‚Ä¢ ·à†·äï·å†·à®·ã° ·â†·àã·ã≠·äõ·ãç ·ä≠·â• ·âÅ·àç·çç ·àã·ã≠ ·ã≠·â≥·ã´·àç<br>
                                    ‚Ä¢ ·âÅ·å•·à© ·ä®·ä≠·â• ·âÅ·àç·çç ·ãà·ã∞ ·ä†·à´·âµ ·àõ·ãï·ãò·äï ·ä†·àû·àå ·ã≠·åà·äì·äõ·àç<br>
                                    ‚Ä¢ ·âÅ·å•·àÆ·âΩ ·ä®·âÄ·äù ·ãà·ã∞ ·åç·à´ ·ã≠·äï·âÄ·à≥·âÄ·à≥·àâ<br>
                                    ‚Ä¢ ·ä®8 ·âÅ·å•·àÆ·âΩ ·â†·àã·ã≠ ·à≤·àÜ·äë ·ã®·å•·äï·â≥·ãä·ãç ·â∞·ãà·åç·ã∑·àç
                                </div>
                                <div class="help-text">
                                    ‚Ä¢ Numbers auto-call every 7 seconds<br>
                                    ‚Ä¢ Current number appears on circular button<br>
                                    ‚Ä¢ Number moves from circular button to bar<br>
                                    ‚Ä¢ Numbers scroll right to left<br>
                                    ‚Ä¢ Oldest numbers disappear after 8 calls
                                </div>
                            </div>
                        </div>
                        
                        <!-- 75-Ball Tab -->
                        <div class="help-tab-content" id="help-75ball">
                            <div class="help-section">
                                <div class="help-title amharic-text">75-·â¢·äï·åé / 75-Ball Bingo</div>
                                <div class="help-text amharic-text">
                                    <strong>·ã®·å®·ãã·â≥ ·àµ·à≠·ãì·âµ:</strong> 5√ó5 ·çç·à≠·åç·à≠·åç (BINGO ·çä·ã∞·àé·âΩ)<br>
                                    <strong>·âÅ·å•·à≠ ·ä≠·àç·àç:</strong> 1-75<br>
                                    <strong>·ã®·âµ·à≠·åâ·àù ·äï·ãµ·çé·âΩ:</strong><br>
                                    ‚Ä¢ ·à®·ãµ·çç - 5 ·âÅ·å•·àÆ·âΩ ·â†·ä†·äï·ãµ ·à®·ãµ·çç<br>
                                    ‚Ä¢ ·ä†·àù·ãµ - 5 ·âÅ·å•·àÆ·âΩ ·â†·ä†·äï·ãµ ·ä†·àù·ãµ<br>
                                    ‚Ä¢ ·ã≤·ã´·åç·äì·àç - 5 ·âÅ·å•·àÆ·âΩ ·â†·ã≤·ã´·åç·äì·àç<br>
                                    ‚Ä¢ ·ä†·à´·âµ ·àõ·ä•·ãò·äñ·âΩ - 4 ·àõ·ä•·ãò·äñ·âΩ ·àù·àç·ä≠·âµ ·ã´·ãµ·à≠·åâ<br>
                                    ‚Ä¢ ·àô·àâ ·â§·âµ - ·àÅ·àâ·äï·àù ·âÅ·å•·àÆ·âΩ ·àù·àç·ä≠·âµ ·ã´·ãµ·à≠·åâ<br>
                                    <strong>·àò·àÉ·àç ·àï·ãã·àµ:</strong> ·äê·çÉ ·â¶·â≥ - ·â†·àõ·à∏·äê·çç ·åä·ãú ·â•·âª ·ã≠·äï·ä©
                                </div>
                                <div class="help-text">
                                    <strong>Game System:</strong> 5√ó5 grid (BINGO letters)<br>
                                    <strong>Number Range:</strong> 1-75<br>
                                    <strong>Winning Patterns:</strong><br>
                                    ‚Ä¢ Row - 5 numbers in one row<br>
                                    ‚Ä¢ Column - 5 numbers in one column<br>
                                    ‚Ä¢ Diagonal - 5 numbers diagonally<br>
                                    ‚Ä¢ Four Corners - Mark all 4 corners<br>
                                    ‚Ä¢ Full House - Mark all numbers<br>
                                    <strong>Center Cell:</strong> Free space - Click only when winning
                                </div>
                            </div>
                        </div>
                        
                        <!-- 90-Ball Tab -->
                        <div class="help-tab-content" id="help-90ball">
                            <div class="help-section">
                                <div class="help-title amharic-text">90-·â¢·äï·åé / 90-Ball Bingo</div>
                                <div class="help-text amharic-text">
                                    <strong>·ã®·å®·ãã·â≥ ·àµ·à≠·ãì·âµ:</strong> 9√ó3 ·çç·à≠·åç·à≠·åç<br>
                                    <strong>·âÅ·å•·à≠ ·ä≠·àç·àç:</strong> 1-90<br>
                                    <strong>·ã®·âµ·à≠·åâ·àù ·äï·ãµ·çé·âΩ:</strong><br>
                                    ‚Ä¢ ·ä†·äï·ãµ ·à®·ãµ·çç - 5 ·âÅ·å•·àÆ·âΩ ·â†·ä†·äï·ãµ ·à®·ãµ·çç<br>
                                    ‚Ä¢ ·àÅ·àà·âµ ·à®·ãµ·çç - 10 ·âÅ·å•·àÆ·âΩ ·â†·àÅ·àà·âµ ·à®·ãµ·çç<br>
                                    ‚Ä¢ ·àô·àâ ·â§·âµ - 15 ·âÅ·å•·àÆ·âΩ ·àÅ·àâ·àù<br>
                                    <strong>·àò·àÉ·àç ·àï·ãã·àµ:</strong> ·â†·àò·å´·ãà·âµ ·ãà·âÖ·âµ ·âÅ·å•·à≠·ç£ ·â†·àõ·à∏·äê·çç ·åä·ãú ·ä†·à∏·äì·çä ·âÅ·àç·çç
                                </div>
                                <div class="help-text">
                                    <strong>Game System:</strong> 9√ó3 grid<br>
                                    <strong>Number Range:</strong> 1-90<br>
                                    <strong>Winning Patterns:</strong><br>
                                    ‚Ä¢ One Line - 5 numbers in one row<br>
                                    ‚Ä¢ Two Lines - 10 numbers in two rows<br>
                                    ‚Ä¢ Full House - All 15 numbers<br>
                                    <strong>Center Cell:</strong> Number during play, winner key when winning
                                </div>
                            </div>
                        </div>
                        
                        <!-- 30-Ball Tab -->
                        <div class="help-tab-content" id="help-30ball">
                            <div class="help-section">
                                <div class="help-title amharic-text">30-·â¢·äï·åé / 30-Ball Bingo</div>
                                <div class="help-text amharic-text">
                                    <strong>·ã®·å®·ãã·â≥ ·àµ·à≠·ãì·âµ:</strong> 3√ó3 ·çç·à≠·åç·à≠·åç<br>
                                    <strong>·âÅ·å•·à≠ ·ä≠·àç·àç:</strong> 1-30<br>
                                    <strong>·ã®·âµ·à≠·åâ·àù ·äï·ãµ·çç:</strong><br>
                                    ‚Ä¢ ·àô·àâ ·â§·âµ - ·àÅ·àâ·äï·àù 9 ·âÅ·å•·àÆ·âΩ ·àù·àç·ä≠·âµ ·ã´·ãµ·à≠·åâ<br>
                                    <strong>·àò·àÉ·àç ·àï·ãã·àµ:</strong> ·â†·àò·å´·ãà·âµ ·ãà·âÖ·âµ ·âÅ·å•·à≠·ç£ ·â†·àõ·à∏·äê·çç ·åä·ãú ·ä†·à∏·äì·çä ·âÅ·àç·çç
                                </div>
                                <div class="help-text">
                                    <strong>Game System:</strong> 3√ó3 grid<br>
                                    <strong>Number Range:</strong> 1-30<br>
                                    <strong>Winning Pattern:</strong><br>
                                    ‚Ä¢ Full House - Mark all 9 numbers<br>
                                    <strong>Center Cell:</strong> Number during play, winner key when winning
                                </div>
                            </div>
                        </div>
                        
                        <!-- 50-Ball Tab -->
                        <div class="help-tab-content" id="help-50ball">
                            <div class="help-section">
                                <div class="help-title amharic-text">50-·â¢·äï·åé / 50-Ball Bingo</div>
                                <div class="help-text amharic-text">
                                    <strong>·ã®·å®·ãã·â≥ ·àµ·à≠·ãì·âµ:</strong> 5√ó5 ·çç·à≠·åç·à≠·åç<br>
                                    <strong>·âÅ·å•·à≠ ·ä≠·àç·àç:</strong> 1-50<br>
                                    <strong>·ã®·âµ·à≠·åâ·àù ·äï·ãµ·çé·âΩ:</strong><br>
                                    ‚Ä¢ ·à®·ãµ·çç - 5 ·âÅ·å•·àÆ·âΩ ·â†·ä†·äï·ãµ ÔøΩ·à®·ãµ·çç<br>
                                    ‚Ä¢ ·ä†·àù·ãµ - 5 ·âÅ·å•·àÆ·âΩ ·â†·ä†·äï·ãµ ·ä†·àù·ãµ<br>
                                    ‚Ä¢ ·ã≤·ã´·åç·äì·àç - 5 ·âÅ·å•·àÆ·âΩ ·â†·ã≤·ã´·åç·äì·àç<br>
                                    ‚Ä¢ ·ä†·à´·âµ ·àõ·ä•·ãò·äñ·âΩ - 4 ·àõ·ä•·ãò·äñ·âΩ ·àù·àç·ä≠·âµ ·ã´·ãµ·à≠·åâ<br>
                                    <strong>·àò·àÉ·àç ·àï·ãã·àµ:</strong> ·â†·àò·å´·ãà·âµ ·ãà·âÖ·âµ ·âÅ·å•·à≠·ç£ ·â†·àõ·à∏·äê·çç ·åä·ãú ·ä†·à∏·äì·çä ·âÅ·àç·çç
                                </div>
                                <div class="help-text">
                                    <strong>Game System:</strong> 5√ó5 grid<br>
                                    <strong>Number Range:</strong> 1-50<br>
                                    <strong>Winning Patterns:</strong><br>
                                    ‚Ä¢ Row - 5 numbers in one row<br>
                                    ‚Ä¢ Column - 5 numbers in one column<br>
                                    ‚Ä¢ Diagonal - 5 numbers diagonally<br>
                                    ‚Ä¢ Four Corners - Mark all 4 corners<br>
                                    <strong>Center Cell:</strong> Number during play, winner key when winning
                                </div>
                            </div>
                        </div>
                        
                        <!-- Pattern Bingo Tab -->
                        <div class="help-tab-content" id="help-pattern">
                            <div class="help-section">
                                <div class="help-title amharic-text">·äï·ãµ·çç ·â¢·äï·åé / Pattern Bingo</div>
                                <div class="help-text amharic-text">
                                    <strong>·ã®·å®·ãã·â≥ ·àµ·à≠·ãì·âµ:</strong> 5√ó5 ·çç·à≠·åç·à≠·åç<br>
                                    <strong>·âÅ·å•·à≠ ·ä≠·àç·àç:</strong> 1-75<br>
                                    <strong>·ã®·âµ·à≠·åâ·àù ·äï·ãµ·çé·âΩ:</strong><br>
                                    ‚Ä¢ X ·äï·ãµ·çç - X ·âÖ·à≠·åΩ ·ã´·àà·ãç ·äï·ãµ·çç<br>
                                    ‚Ä¢ ·ä†·ãç·à´ ·âÄ·àà·â†·âµ - ·ãç·å´·ãä ·ä≠·â†·â• ·äï·ãµ·çç<br>
                                    ‚Ä¢ ·àõ·àÖ·â∞·àù - 4 ·ä´·à¨·ãé·âΩ ·äï·ãµ·çç<br>
                                    ‚Ä¢ ·ã≤·ã´·àù·äï·ãµ - ·ã≤·ã´·àù·äï·ãµ ·âÖ·à≠·åΩ ·ã´·àà·ãç ·äï·ãµ·çç<br>
                                    <strong>·àò·àÉ·àç ·àï·ãã·àµ:</strong> ·äê·çÉ ·â¶·â≥ - ·â†·àõ·à∏·äê·çç ·åä·ãú ·â•·âª ·ã≠·äï·ä©
                                </div>
                                <div class="help-text">
                                    <strong>Game System:</strong> 5√ó5 grid<br>
                                    <strong>Number Range:</strong> 1-75<br>
                                    <strong>Winning Patterns:</strong><br>
                                    ‚Ä¢ X Pattern - X-shaped pattern<br>
                                    ‚Ä¢ Frame - Outer frame pattern<br>
                                    ‚Ä¢ Postage Stamp - 4 squares pattern<br>
                                    ‚Ä¢ Small Diamond - Diamond-shaped pattern<br>
                                    <strong>Center Cell:</strong> Free space - Click only when winning
                                </div>
                            </div>
                        </div>
                        
                        <!-- Coverall Tab -->
                        <div class="help-tab-content" id="help-coverall">
                            <div class="help-section">
                                <div class="help-title amharic-text">·àô·àâ ·â§·âµ / Coverall Bingo</div>
                                <div class="help-text amharic-text">
                                    <strong>·ã®·å®·ãã·â≥ ·àµ·à≠·ãì·âµ:</strong> 9√ó5 ·çç·à≠·åç·à≠·åç<br>
                                    <strong>·âÅ·å•·à≠ ·ä≠·àç·àç:</strong> 1-90 (45 ·âÅ·å•·àÆ·âΩ ·â•·âª)<br>
                                    <strong>·ã®·âµ·à≠·åâ·àù ·äï·ãµ·çç:</strong><br>
                                    ‚Ä¢ ·àô·àâ ·â¶·à≠·ãµ - ·àÅ·àâ·äï·àù 45 ·âÅ·å•·àÆ·âΩ ·àù·àç·ä≠·âµ ·ã´·ãµ·à≠·åâ<br>
                                    <strong>·àò·àÉ·àç ·àï·ãã·àµ:</strong> ·â†·àò·å´·ãà·âµ ·ãà·âÖ·âµ ·âÅ·å•·à≠·ç£ ·â†·àõ·à∏·äê·çç ·åä·ãú ·ä†·à∏·äì·çä ·âÅ·àç·çç
                                </div>
                                <div class="help-text">
                                    <strong>Game System:</strong> 9√ó5 grid<br>
                                    <strong>Number Range:</strong> 1-90 (only 45 numbers)<br>
                                    <strong>Winning Pattern:</strong><br>
                                    ‚Ä¢ Full Board - Mark all 45 numbers<br>
                                    <strong>Center Cell:</strong> Number during play, winner key when winning
                                </div>
                            </div>
                        </div>
                        
                        <!-- Winning Process Tab -->
                        <div class="help-tab-content" id="help-winning">
                            <div class="help-section">
                                <div class="help-title amharic-text">·ã®·àõ·à∏·äê·çç ·àÇ·ã∞·âµ / Winning Process</div>
                                <div class="help-text amharic-text">
                                    1. ·âÅ·å•·àÆ·âΩ·äï ·àù·àç·ä≠·âµ ·ã´·ãµ·à≠·åâ<br>
                                    2. ·äï·ãµ·çç ·àô·àâ ·à≤·àÜ·äï "·ä†·à∏·äì·çä ·äì·àà·àÅ!" ·âÅ·àç·çâ·äï ·ã≠·äï·ä©<br>
                                    3. ·ã®·àõ·à∏·äê·çç ·àõ·à≥·ãà·âÇ·ã´ ·ã≠·â≥·ã´·àç<br>
                                    4. ·àΩ·àç·àõ·âµ ·â†·çã·ã≠·äì·äï·àµ ·åà·åΩ ·àã·ã≠ ·ã≠·å®·àù·à´·àç<br>
                                    5. ·àΩ·àç·àõ·âµ ·â†·ä†·ä´·ãç·äï·âµ ·àõ·ãç·å£·âµ ·ã≠·âΩ·àã·àâ
                                </div>
                                <div class="help-text">
                                    1. Mark numbers on your card<br>
                                    2. Click "I'm Winner!" button when pattern completes<br>
                                    3. Winner notification appears<br>
                                    4. Prize added to finance page<br>
                                    5. Withdraw prize to your account
                                </div>
                            </div>
                            
                            <div class="help-section">
                                <div class="help-title amharic-text">·ã®·àõ·à∏·äê·çç ·ä†·ã≠·äê·â∂·âΩ / Winning Types</div>
                                <div class="help-text amharic-text">
                                    ‚Ä¢ ·à®·ãµ·çç - 5 ·âÅ·å•·àÆ·âΩ ·â†·ä†·äï·ãµ ·à®·ãµ·çç<br>
                                    ‚Ä¢ ·ä†·àù·ãµ - 5 ·âÅ·å•·àÆ·âΩ ·â†·ä†·äï·ãµ ·ä†·àù·ãµ<br>
                                    ‚Ä¢ ·ã≤·ã´·åç·äì·àç - 5 ·âÅ·å•·àÆ·âΩ ·â†·ã≤·ã´·åç·äì·àç<br>
                                    ‚Ä¢ ·ä†·à´·âµ ·àõ·ä•·ãò·äñ·âΩ - 4 ·àõ·ä•·ãò·äñ·âΩ<br>
                                    ‚Ä¢ ·àô·àâ ·â§·âµ - ·àÅ·àâ·àù ·âÅ·å•·àÆ·âΩ<br>
                                    ‚Ä¢ X ·äï·ãµ·çç - X ·âÖ·à≠·åΩ<br>
                                    ‚Ä¢ ·ä†·ãç·à´ ·âÄ·àà·â†·âµ - ·ãç·å´·ãä ·ä≠·â†·â•<br>
                                    ‚Ä¢ ·àô·àâ ·â¶·à≠·ãµ - ·àÅ·àâ·àù 45 ·âÅ·å•·àÆ·âΩ
                                </div>
                                <div class="help-text">
                                    ‚Ä¢ Row - 5 numbers in one row<br>
                                    ‚Ä¢ Column - 5 numbers in one column<br>
                                    ‚Ä¢ Diagonal - 5 numbers diagonally<br>
                                    ‚Ä¢ Four Corners - 4 corners<br>
                                    ‚Ä¢ Full House - All numbers<br>
                                    ‚Ä¢ X Pattern - X shape<br>
                                    ‚Ä¢ Frame - Outer frame<br>
                                    ‚Ä¢ Full Board - All 45 numbers
                                </div>
                            </div>
                        </div>
                        
                        <!-- Payment System Tab -->
                        <div class="help-tab-content" id="help-payment">
                            <div class="help-section">
                                <div class="help-title amharic-text">·ã®·ä≠·çç·ã´ ·àµ·à≠·ãì·âµ / Payment System</div>
                                <div class="help-text amharic-text">
                                    <strong>·ã®·ä≠·çç·ã´ ·ä†·àõ·à´·åÆ·âΩ:</strong><br>
                                    ‚Ä¢ 25 ·â•·à≠ - ·àò·à∞·à®·â≥·ãä ·ä≠·çç·ã´<br>
                                    ‚Ä¢ 50 ·â•·à≠ - ·àò·ä´·ä®·àà·äõ ·ä≠·çç·ã´<br>
                                    ‚Ä¢ 100 ·â•·à≠ - ·àò·ã∞·â†·äõ ·ä≠·çç·ã´<br>
                                    ‚Ä¢ 200 ·â•·à≠ - ·ä®·çç·â∞·äõ ·ä≠·çç·ã´<br>
                                    ‚Ä¢ 500 ·â•·à≠ - ·â•·à≠·âÖ ·ä≠·çç·ã´<br>
                                    ‚Ä¢ 1000 ·â•·à≠ - ·àç·ã© ·ä≠·çç·ã´<br>
                                    ‚Ä¢ 2000 ·â•·à≠ - ·ä®·çç·â∞·äõ ·àç·ã© ·ä≠·çç·ã´<br>
                                    ‚Ä¢ 5000 ·â•·à≠ - ·â†·å£·àù ·ä®·çç·â∞·äõ<br>
                                    <strong>·àõ·à≥·à∞·â¢·ã´:</strong> 3% ·ä†·åà·àç·åç·àé·âµ ·ä≠·çç·ã´ ·ã≠·âÄ·äï·à≥·àç
                                </div>
                                <div class="help-text">
                                    <strong>Payment Options:</strong><br>
                                    ‚Ä¢ 25 Birr - Basic payment<br>
                                    ‚Ä¢ 50 Birr - Medium payment<br>
                                    ‚Ä¢ 100 Birr - Regular payment<br>
                                    ‚Ä¢ 200 Birr - High payment<br>
                                    ‚Ä¢ 500 Birr - Premium payment<br>
                                    ‚Ä¢ 1000 Birr - Special payment<br>
                                    ‚Ä¢ 2000 Birr - High special payment<br>
                                    ‚Ä¢ 5000 Birr - Very high<br>
                                    <strong>Note:</strong> 3% service charge is deducted
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="fixed-controls">
                    <button class="control-btn btn-success" onclick="showPage(0)">·â∞·àò·àà·àµ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Members Modal -->
    <div class="members-modal" id="membersModal">
        <div class="modal-content">
            <div class="modal-header amharic-text">·â∞·å´·ãã·âæ·âΩ (<span id="membersCount">0</span>)</div>
            
            <table class="members-table">
                <thead>
                    <tr>
                        <th class="amharic-text">·â∞.·âÅ.</th>
                        <th class="amharic-text">·àµ·àù</th>
                        <th class="amharic-text">·àµ·àç·ä≠</th>
                        <th class="amharic-text">·ä≠·çç·ã´</th>
                        <th class="amharic-text">·ãç·à≠·à≠·ãµ</th>
                        <th class="amharic-text">·àö·ãõ·äï</th>
                    </tr>
                </thead>
                <tbody id="membersList">
                    <!-- Members will be added here -->
                </tbody>
            </table>
            
            <div class="fixed-controls" style="position: relative; margin-top: 15px; background: transparent; border: none;">
                <button class="control-btn btn-success" onclick="closeModal('membersModal')">·ä•·à∫</button>
            </div>
        </div>
    </div>

    <!-- Potential Win Modal -->
    <div class="potential-win-modal" id="potentialWinModal">
        <div class="modal-content">
            <div class="modal-header amharic-text">·ã®·àõ·à∏·äê·çç ·ä•·ãµ·àç</div>
            
            <table class="winning-table">
                <thead>
                    <tr>
                        <th class="amharic-text">·ãç·à≠·à≠·ãµ ·àò·å†·äï</th>
                        <th class="amharic-text">·àΩ·àç·àõ·âµ</th>
                    </tr>
                </thead>
                <tbody id="winningTableBody">
                    <!-- Winning amounts will be added here -->
                </tbody>
            </table>
            
            <div style="margin-top: 15px; padding: 10px; background: rgba(255, 215, 0, 0.1); border-radius: 8px; border: 1px solid #ffd700;">
                <div class="amharic-text" style="text-align: center; font-size: 14px; color: #28a745; margin-top: 5px; font-weight: bold;">
                    ·àä·à∏·äê·çç ·ã®·àö·âΩ·àç ·àΩ·àç·àõ·âµ: <span id="currentWinDisplay">0</span> ·â•·à≠
                </div>
                <div class="amharic-text" style="text-align: center; font-size: 11px; color: #ffd700; margin-top: 5px;">
                    ·àõ·à≥·à∞·â¢·ã´: 3% ·ä†·åà·àç·åç·àé·âµ ·ä≠·çç·ã´ ·ã≠·âÄ·äï·à≥·àç
                </div>
            </div>
            
            <div class="fixed-controls" style="position: relative; margin-top: 15px; background: transparent; border: none;">
                <button class="control-btn btn-success" onclick="closeModal('potentialWinModal')">·ä•·à∫</button>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div class="notification" id="notification">
        <div id="notificationText" class="amharic-text"></div>
        <div class="fixed-controls" style="position: relative; margin-top: 15px; background: transparent; border: none;">
            <button class="control-btn btn-secondary" onclick="hideNotification()">·ä•·à∫</button>
            <button class="control-btn btn-success" id="continueBtn" onclick="continueWithIncomplete()">·âÄ·å•·àç</button>
        </div>
    </div>

    <!-- Winner Popup -->
    <div class="winner-notification" id="winnerNotification">
        <div style="font-size: 32px; margin-bottom: 15px;">üéâ ·â¢·äï·åé! üéâ</div>
        <div class="winner-name amharic-text" id="winnerName"></div>
        <div class="winning-pattern amharic-text" id="winPattern"></div>
        <div class="win-amount amharic-text" id="displayWinAmount">0 ·â•·à≠</div>
        <div style="margin: 15px 0; color: #ffd700;" class="amharic-text" id="winnerStatus">·â†·àõ·à®·åã·åà·å• ·àã·ã≠...</div>
        <div class="fixed-controls" style="position: relative; bottom: 0; left: 0; right: 0; margin-top: 20px; background: transparent; border: none;">
            <button class="control-btn btn-success" onclick="continueGame()" id="continueGameBtn">·âÄ·å•·à≠</button>
            <button class="control-btn btn-info" onclick="showPage(4)">·ä†·ãç·å£</button>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div style="color: #ffd700; font-weight: bold; text-align: center; margin-bottom: 15px;" class="amharic-text">
            ·ä†·àµ·â∞·ã≥·ã∞·à≠ ·çì·äê·àç - ·â†·âÄ·å•·â≥ ·ã≠·åç·â£·äù: <span id="activePlayers">0</span> ·â∞·å´·ãã·âæ·âΩ
        </div>
        <div class="admin-controls">
            <button class="admin-btn admin-start" onclick="sendAdminCommand('start')">·å®·ãã·â≥ ·åÄ·àù·à≠</button>
            <button class="admin-btn admin-stop" onclick="sendAdminCommand('stop')">·ä†·âÅ·àù</button>
            <button class="admin-btn admin-call" onclick="sendAdminCommand('call')">·âÅ·å•·à≠ ·å•·à´</button>
            <button class="admin-btn admin-reset" onclick="sendAdminCommand('reset')">·ä†·ã≤·àµ ·åÄ·àù·à≠</button>
        </div>
        <div style="color: white; font-size: 12px; text-align: center; margin-top: 10px;" class="amharic-text">
            ·ä†·àÅ·äï ·ã®·â∞·å†·à© ·âÅ·å•·àÆ·âΩ: <span id="adminCalledCount">0</span>
        </div>
        <div class="fixed-controls" style="position: relative; margin-top: 15px; background: transparent; border: none;">
            <button class="control-btn btn-secondary" onclick="toggleAdminPanel()">·ãù·åã</button>
        </div>
    </div>

    <script>
        // WebSocket Configuration
        const WS_URL = window.location.hostname === 'localhost' || 
                      window.location.hostname === '127.0.0.1' ? 
                      'ws://localhost:8080' : 
                      'wss://assefa-bingo-backend.deno.dev'; // Change to your Deno Deploy URL

        // Game State - Optimized
        const gameState = {
            gameType: null,
            payment: 0,
            paymentAmount: 25,
            stake: 25,
            totalWon: 0,
            boardId: 1,
            calledNumbers: [],
            markedNumbers: new Set(),
            gameActive: false,
            playerName: '',
            playerPhone: '',
            totalWithdrawn: 0,
            members: [],
            currentNumber: null,
            winningPatterns: {
                '75ball': ['row', 'column', 'diagonal', 'four-corners', 'full-house'],
                '90ball': ['one-line', 'two-lines', 'full-house'],
                '30ball': ['full-house'],
                '50ball': ['row', 'column', 'diagonal', 'four-corners', 'full-house'],
                'pattern': ['x-pattern', 'frame', 'postage-stamp', 'small-diamond'],
                'coverall': ['full-board']
            },
            winConditions: {
                'row': '·à®·ãµ·çç',
                'column': '·ä†·àù·ãµ',
                'diagonal': '·ã≤·ã´·åç·äì·àç',
                'four-corners': '·ä†·à´·âµ ·àõ·ä•·ãò·äñ·âΩ',
                'full-house': '·àô·àâ ·â§·âµ',
                'one-line': '·ä†·äï·ãµ ·à®·ãµ·çç',
                'two-lines': '·àÅ·àà·âµ ·à®·ãµ·çç',
                'x-pattern': 'X ·äï·ãµ·çç',
                'frame': '·ä†·ãç·à´ ·âÄ·àà·â†·âµ',
                'postage-stamp': '·àõ·àÖ·â∞·àù',
                'small-diamond': '·ã≤·ã´·àù·äï·ãµ',
                'full-board': '·àô·àâ ·â¶·à≠·ãµ'
            },
            ws: null,
            playerId: null,
            isAdmin: false,
            adminPassword: 'asse2123',
            connectionAttempts: 0,
            maxConnectionAttempts: 5
        };

        // Board Types
        const boardTypes = [
            { id: '75ball', name: '75-·â¢·äï·åé', icon: 'üéØ', desc: '5√ó5 ·ä®BINGO', range: 75, columns: 5 },
            { id: '90ball', name: '90-·â¢·äï·åé', icon: 'üá¨üáß', desc: '9√ó3 ·çà·å£·äï', range: 90, columns: 9 },
            { id: '30ball', name: '30-·â¢·äï·åé', icon: '‚ö°', desc: '3√ó3 ·çç·å•·äê·âµ', range: 30, columns: 3 },
            { id: '50ball', name: '50-·â¢·äï·åé', icon: 'üé≤', desc: '5√ó5 ·ä®BINGO', range: 50, columns: 5 },
            { id: 'pattern', name: '·äï·ãµ·çç ·â¢·äï·åé', icon: '‚ú®', desc: '·â∞·å†·âÄ·àù ·äï·ãµ·çç', range: 75, columns: 5 },
            { id: 'coverall', name: '·àô·àâ ·â§·âµ', icon: 'üèÜ', desc: '·àÅ·àâ·äï·àù ·àù·àç·ä≠·âµ ·ã´·ãµ·à≠·åâ', range: 90, columns: 9 }
        ];

        // WebSocket Functions
        function connectWebSocket() {
            try {
                updateConnectionStatus('connecting', '·ã®·àö·åà·äì·äù...');
                
                const ws = new WebSocket(WS_URL);
                
                ws.onopen = () => {
                    console.log('WebSocket connected');
                    updateConnectionStatus('connected', '·â∞·åà·äì·äù·â∑·àç');
                    gameState.connectionAttempts = 0;
                    
                    // Check if admin from URL
                    const urlParams = new URLSearchParams(window.location.search);
                    if (urlParams.get('admin') === 'true') {
                        const password = prompt('·ã®·ä†·àµ·â∞·ã≥·ã∞·à≠ ·ã®·ã≠·àà·çç ·âÉ·àç ·ã´·àµ·åà·â°:', '');
                        if (password === gameState.adminPassword) {
                            gameState.isAdmin = true;
                            sendMessage({ type: 'admin_login', password: password });
                            showAdminPanel();
                        }
                    }
                };
                
                ws.onmessage = (event) => {
                    try {
                        const message = JSON.parse(event.data);
                        handleWebSocketMessage(message);
                    } catch (error) {
                        console.error('Error parsing message:', error);
                    }
                };
                
                ws.onclose = () => {
                    console.log('WebSocket disconnected');
                    updateConnectionStatus('disconnected', '·àò·åà·äì·äõ ·â∞·âã·à≠·åß·àç');
                    
                    // Attempt reconnection
                    if (gameState.connectionAttempts < gameState.maxConnectionAttempts) {
                        gameState.connectionAttempts++;
                        setTimeout(() => {
                            connectWebSocket();
                        }, 3000 * gameState.connectionAttempts);
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('WebSocket error:', error);
                    updateConnectionStatus('disconnected', '·àµ·àÖ·â∞·âµ ·â∞·çà·å•·àØ·àç');
                };
                
                gameState.ws = ws;
            } catch (error) {
                console.error('Failed to connect:', error);
                updateConnectionStatus('disconnected', '·àò·åà·äì·äõ ·ä†·àç·â∞·à≥·ä´·àù');
            }
        }

        function sendMessage(message) {
            if (gameState.ws && gameState.ws.readyState === WebSocket.OPEN) {
                gameState.ws.send(JSON.stringify(message));
                return true;
            } else {
                console.warn('WebSocket not connected');
                updateConnectionStatus('disconnected', '·àò·åà·äì·äõ ·ã®·àà·àù');
                return false;
            }
        }

        function handleWebSocketMessage(message) {
            console.log('Received message:', message);
            
            switch(message.type) {
                case 'connected':
                    gameState.playerId = message.playerId;
                    updateConnectionStatus('connected', `·â∞·åà·äì·äù·â∞·ãã·àç (ID: ${message.playerId})`);
                    break;
                    
                case 'game_state':
                    updateGameState(message.state);
                    break;
                    
                case 'number_called':
                    handleNumberCalled(message.number, message.display);
                    break;
                    
                case 'game_started':
                    showNotification('·å®·ãã·â≥ ·â∞·åÄ·àù·àØ·àç! ·âÅ·å•·àÆ·âΩ ·ã≠·å†·à´·àâ...', false);
                    gameState.gameActive = true;
                    break;
                    
                case 'game_stopped':
                    showNotification('·å®·ãã·â≥ ·â∞·ãà·åç·ã∑·àç', false);
                    gameState.gameActive = false;
                    break;
                    
                case 'winner_announced':
                    handleWinnerAnnounced(message.winnerName, message.pattern, message.amount);
                    break;
                    
                case 'winner_verified':
                    handleWinnerVerified(message.winnerId, message.verified);
                    break;
                    
                case 'players_update':
                    updatePlayersList(message.players);
                    break;
                    
                case 'error':
                    showNotification(message.message, false);
                    break;
                    
                case 'admin_login_success':
                    gameState.isAdmin = true;
                    showNotification('·ä•·äï·ä≥·äï ·ãà·ã∞ ·ä†·àµ·â∞·ã≥·ã∞·à≠ ·çì·äê·àç ·â†·ã∞·àÖ·äì ·àò·å°', false);
                    break;
                    
                case 'admin_login_failed':
                    gameState.isAdmin = false;
                    showNotification('·ã®·ã≠·àà·çç ·âÉ·àç ·ã®·â∞·à≥·à≥·â∞ ·äê·ãç', false);
                    break;
            }
        }

        function updateGameState(state) {
            if (state.calledNumbers) {
                gameState.calledNumbers = state.calledNumbers;
                updateCalledNumbersDisplay();
            }
            
            if (state.gameActive !== undefined) {
                gameState.gameActive = state.gameActive;
            }
            
            if (state.players) {
                updatePlayersList(state.players);
            }
            
            if (gameState.isAdmin) {
                document.getElementById('activePlayers').textContent = state.players ? state.players.length : 0;
                document.getElementById('adminCalledCount').textContent = state.calledNumbers ? state.calledNumbers.length : 0;
            }
        }

        function handleNumberCalled(number, display) {
            gameState.calledNumbers.push(number);
            
            // Update UI
            const bar = document.getElementById('calledNumbersBar');
            const span = document.createElement('span');
            span.className = 'called-number amharic-text';
            span.textContent = display || number;
            bar.appendChild(span);
            
            // Keep only last 8 numbers
            while (bar.children.length > 8) {
                bar.removeChild(bar.firstChild);
            }
            
            // Scroll to end
            bar.scrollLeft = bar.scrollWidth;
            
            // Play sound
            const audio = document.getElementById('callAudio');
            audio.currentTime = 0;
            audio.play().catch(() => {});
            
            // Mark number on board if exists
            markNumberOnBoard(number);
        }

        function markNumberOnBoard(number) {
            const cells = document.querySelectorAll('.board-cell[data-number]');
            cells.forEach(cell => {
                if (parseInt(cell.dataset.number) === number) {
                    if (!cell.classList.contains('marked')) {
                        cell.classList.add('marked');
                        gameState.markedNumbers.add(number);
                    }
                }
            });
        }

        function updatePlayersList(players) {
            gameState.members = players;
            document.getElementById('membersCount').textContent = players.length;
        }

        function handleWinnerAnnounced(winnerName, pattern, amount) {
            // Show winner notification to all players
            document.getElementById('winnerName').textContent = winnerName;
            document.getElementById('winPattern').textContent = gameState.winConditions[pattern] || pattern;
            document.getElementById('displayWinAmount').textContent = `${amount.toLocaleString()} ·â•·à≠`;
            document.getElementById('winnerStatus').textContent = '·â†·àõ·à®·åã·åà·å• ·àã·ã≠...';
            document.getElementById('winnerNotification').style.display = 'block';
            
            const audio = document.getElementById('winAudio');
            audio.currentTime = 0;
            audio.play().catch(() => {});
        }

        function handleWinnerVerified(winnerId, verified) {
            if (gameState.playerId === winnerId) {
                if (verified) {
                    document.getElementById('winnerStatus').textContent = '·ä†·à®·åã·åç·åß·àç ‚úì';
                    document.getElementById('continueGameBtn').style.display = 'flex';
                    // Update player's winnings
                    const winAmount = calculatePotentialWin(gameState.stake);
                    gameState.totalWon += winAmount;
                    updateFinance();
                } else {
                    document.getElementById('winnerStatus').textContent = '·â∞·âÄ·â£·ã≠·äê·âµ ·ä†·àã·åà·äò·àù ‚úó';
                    document.getElementById('continueGameBtn').style.display = 'flex';
                }
            }
        }

        // Update Connection Status UI
        function updateConnectionStatus(status, text) {
            const statusDiv = document.getElementById('connectionStatus');
            const statusIcon = document.getElementById('statusIcon');
            const statusText = document.getElementById('statusText');
            
            statusDiv.className = `connection-status status-${status}`;
            statusText.textContent = text;
            
            switch(status) {
                case 'connected':
                    statusIcon.textContent = 'üü¢';
                    break;
                case 'disconnected':
                    statusIcon.textContent = 'üî¥';
                    break;
                case 'connecting':
                    statusIcon.textContent = 'üü°';
                    break;
            }
        }

        // Admin Functions
        function showAdminPanel() {
            document.getElementById('adminPanel').style.display = 'block';
        }

        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function sendAdminCommand(command) {
            if (!gameState.isAdmin) {
                showNotification('·ã®·ä†·àµ·â∞·ã≥·ã∞·à≠ ·àò·â•·âµ ·ã®·àà·ãé·âµ·àù', false);
                return;
            }
            
            sendMessage({ type: 'admin_command', command: command });
        }

        // Calculate potential win
        function calculatePotentialWin(stake) {
            const validMembers = 90; // Always 90 members
            const potential = (0.8 * validMembers * stake * 0.97);
            return Math.floor(potential);
        }

        // Initialize
        function init() {
            setupBoardSelection();
            setupStakeOptions();
            setupBoardNumbers();
            updatePotentialWin();
            
            // Connect to WebSocket
            connectWebSocket();
            
            document.getElementById('nextBtn').onclick = () => {
                if (gameState.gameType) showPage(2);
                else showNotification('·ä•·â£·ä≠·ãé ·ã®·â¶·à≠·ãµ ·ãì·ã≠·äê·âµ ·ã≠·àù·à®·å°', false);
            };
            
            document.getElementById('confirmBtn').onclick = confirmRegistration;
            document.getElementById('playerStake').onchange = updatePotentialWin;
            document.getElementById('paymentAmount').onchange = processPayment;
            document.getElementById('announceBtn').onclick = announceWin;
            
            updateCalledNumbersDisplay();
        }

        // Setup Board Selection
        function setupBoardSelection() {
            const grid = document.getElementById('boardTypeGrid');
            grid.innerHTML = '';
            
            boardTypes.forEach(type => {
                const card = document.createElement('div');
                card.className = 'board-type-card';
                card.innerHTML = `
                    <div class="board-type-icon">${type.icon}</div>
                    <div class="board-type-title amharic-text">${type.name}</div>
                    <div class="board-type-desc amharic-text">${type.desc}</div>
                `;
                card.onclick = () => {
                    document.querySelectorAll('.board-type-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    gameState.gameType = type.id;
                    if (type.id === 'pattern') {
                        const patterns = gameState.winningPatterns.pattern;
                        gameState.currentPattern = patterns[Math.floor(Math.random() * patterns.length)];
                    }
                };
                
                grid.appendChild(card);
            });
        }

        // Setup Stake Options
        function setupStakeOptions() {
            const select = document.getElementById('playerStake');
            const stakes = [25, 50, 100, 200, 500, 1000, 2000, 5000];
            stakes.forEach(stake => {
                const option = document.createElement('option');
                option.value = stake;
                option.textContent = `${stake} ·â•·à≠`;
                select.appendChild(option);
            });
            select.value = 25;
            gameState.stake = 25;
        }

        // Setup Board Numbers
        function setupBoardNumbers() {
            const select = document.getElementById('boardSelect');
            for (let i = 1; i <= 100; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `·â¶·à≠·ãµ ${i}`;
                select.appendChild(option);
            }
            select.value = 1;
        }

        // Show Page
        function showPage(pageNum) {
            document.querySelectorAll('.page-container').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(`page${pageNum}`).classList.add('active');
            
            if (pageNum === 3) {
                generateGameBoard();
            }
            if (pageNum === 4) {
                updateFinance();
            }
            if (pageNum === 5) {
                showHelpTab('general');
            }
        }

        // Show Help Tab
        function showHelpTab(tabId) {
            document.querySelectorAll('.help-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.help-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelector(`.help-nav-btn[onclick="showHelpTab('${tabId}')"]`).classList.add('active');
            document.getElementById(`help-${tabId}`).classList.add('active');
        }

        // Show Members Modal
        function showMembers() {
            const membersList = document.getElementById('membersList');
            membersList.innerHTML = '';
            
            gameState.members.forEach(member => {
                const row = document.createElement('tr');
                row.className = 'member-row';
                row.innerHTML = `
                    <td>${member.id || 'N/A'}</td>
                    <td class="member-name">${member.name || 'Guest'}</td>
                    <td>${member.phone || 'N/A'}</td>
                    <td class="member-paid">‚úì</td>
                    <td>${member.stake || 25} ·â•·à≠</td>
                    <td>${member.balance || 0} ·â•·à≠</td>
                `;
                membersList.appendChild(row);
            });
            
            document.getElementById('membersModal').style.display = 'block';
        }

        // Show Potential Win Modal
        function showPotentialWin() {
            const tbody = document.getElementById('winningTableBody');
            tbody.innerHTML = '';
            
            const stakes = [25, 50, 100, 200, 500, 1000, 2000, 5000];
            stakes.forEach(stake => {
                const winAmount = calculatePotentialWin(stake);
                const row = document.createElement('tr');
                row.className = stake === gameState.stake ? 'current-stake-row' : '';
                row.innerHTML = `
                    <td class="amharic-text">${stake} ·â•·à≠</td>
                    <td class="win-amount">${winAmount.toLocaleString()} ·â•·à≠</td>
                `;
                tbody.appendChild(row);
            });
            
            document.getElementById('potentialWinModal').style.display = 'block';
        }

        // Close Modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Update Potential Win Display
        function updatePotentialWin() {
            const stake = parseInt(document.getElementById('playerStake').value) || 25;
            const winAmount = calculatePotentialWin(stake);
            
            document.getElementById('currentWinDisplay').textContent = winAmount.toLocaleString();
            gameState.stake = stake;
        }

        // Show Notification
        function showNotification(message, showContinue) {
            document.getElementById('notificationText').textContent = message;
            document.getElementById('continueBtn').style.display = showContinue ? 'flex' : 'none';
            document.getElementById('notification').style.display = 'block';
        }

        // Hide Notification
        function hideNotification() {
            document.getElementById('notification').style.display = 'none';
        }

        // Continue with incomplete information
        function continueWithIncomplete() {
            hideNotification();
            gameState.playerName = document.getElementById('playerName').value || 'Guest';
            gameState.playerPhone = document.getElementById('playerPhone').value || '0000000000';
            gameState.stake = parseInt(document.getElementById('playerStake').value) || 25;
            gameState.boardId = document.getElementById('boardSelect').value || 1;
            showPage(3);
        }

        // Process Payment
        function processPayment() {
            const amount = parseInt(document.getElementById('paymentAmount').value);
            
            if (!amount || amount < 25) {
                return;
            }
            
            gameState.payment = amount;
            gameState.paymentAmount = amount;
            
            const select = document.getElementById('paymentAmount');
            select.style.background = '#28a745';
            select.style.color = 'white';
        }

        // Confirm Registration
        function confirmRegistration() {
            const name = document.getElementById('playerName').value;
            const phone = document.getElementById('playerPhone').value;
            const stake = document.getElementById('playerStake').value;
            const board = document.getElementById('boardSelect').value;
            
            const incomplete = !name || !phone || !stake || !board || gameState.payment === 0;
            
            if (incomplete) {
                showNotification('·àò·à®·åÉ·ãé·âΩ ·àô·àâ ·ä†·ã≠·ã∞·àâ·àù·ç¢ ·â†·ãö·àÖ ·àÅ·äî·â≥ ·àò·âÄ·å†·àç ·ã≠·çà·àç·åã·àâ?', true);
                return;
            }
            
            gameState.playerName = name;
            gameState.playerPhone = phone;
            gameState.stake = parseInt(stake);
            gameState.boardId = board;
            
            // Send registration to server
            sendMessage({
                type: 'register',
                playerName: name,
                playerPhone: phone,
                stake: gameState.stake,
                boardId: gameState.boardId,
                gameType: gameState.gameType
            });
            
            showPage(3);
        }

        // Generate Game Board
        function generateGameBoard() {
            const board = document.getElementById('gameBoard');
            const header = document.getElementById('gameHeader');
            const type = boardTypes.find(t => t.id === gameState.gameType);
            
            board.innerHTML = '';
            header.textContent = `${type.name} - ·â¶·à≠·ãµ ${gameState.boardId}`;
            
            if (gameState.gameType === '75ball' || gameState.gameType === '50ball') {
                generateBingoBoard(type);
            } else if (gameState.gameType === '90ball') {
                generate90BallBoard(type);
            } else if (gameState.gameType === '30ball') {
                generate30BallBoard(type);
            } else if (gameState.gameType === 'pattern') {
                generatePatternBoard(type);
            } else if (gameState.gameType === 'coverall') {
                generateCoverallBoard(type);
            }
        }

        // Generate BINGO Board (75/50 ball)
        function generateBingoBoard(type) {
            const board = document.getElementById('gameBoard');
            const wrapper = document.createElement('div');
            wrapper.className = 'board-75-wrapper';
            
            // BINGO Labels
            const labels = document.createElement('div');
            labels.className = 'bingo-labels';
            'BINGO'.split('').forEach(letter => {
                const label = document.createElement('div');
                label.className = 'bingo-label';
                label.textContent = letter;
                labels.appendChild(label);
            });
            wrapper.appendChild(labels);
            
            // Board Grid
            const grid = document.createElement('div');
            grid.className = type.id === '75ball' ? 'board-75' : 'board-50';
            
            const columnRanges = type.id === '75ball' ? 
                [[1,15], [16,30], [31,45], [46,60], [61,75]] :
                [[1,10], [11,20], [21,30], [31,40], [41,50]];
            
            const columnNumbers = columnRanges.map(range => {
                let nums = new Set();
                while (nums.size < 5) {
                    nums.add(Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0]);
                }
                return Array.from(nums).sort((a, b) => a - b);
            });
            
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 5; col++) {
                    const cell = document.createElement('button');
                    cell.className = 'board-cell';
                    
                    if (row === 2 && col === 2) {
                        cell.textContent = '‚òÖ';
                        cell.classList.add('center-cell');
                        cell.dataset.center = 'true';
                        cell.onclick = () => {
                            if (!cell.classList.contains('marked')) {
                                cell.classList.add('marked');
                            }
                        };
                    } else {
                        const num = columnNumbers[col][row];
                        cell.textContent = num;
                        cell.dataset.number = num;
                        cell.dataset.row = row;
                        cell.dataset.column = col;
                        cell.onclick = () => toggleMark(cell, num);
                    }
                    
                    grid.appendChild(cell);
                }
            }
            
            wrapper.appendChild(grid);
            board.appendChild(wrapper);
        }

        // Generate 90 Ball Board
        function generate90BallBoard(type) {
            const board = document.getElementById('gameBoard');
            const wrapper = document.createElement('div');
            wrapper.className = 'board-90-wrapper';
            
            // Column labels
            const labels = document.createElement('div');
            labels.className = 'board-90-labels';
            for (let i = 1; i <= 9; i++) {
                const label = document.createElement('div');
                label.className = 'board-90-label';
                label.textContent = `${(i-1)*10+1}-${i*10}`;
                labels.appendChild(label);
            }
            wrapper.appendChild(labels);
            
            // Board Grid
            const grid = document.createElement('div');
            grid.className = 'board-90';
            
            const ranges = [
                [1,10], [11,20], [21,30], [31,40], [41,50],
                [51,60], [61,70], [71,80], [81,90]
            ];
            
            const columnNumbers = ranges.map(range => {
                const count = Math.floor(Math.random() * 3) + 1;
                let nums = new Set();
                while (nums.size < count) {
                    nums.add(Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0]);
                }
                return Array.from(nums).sort((a, b) => a - b);
            });
            
            const layout = Array(3).fill().map(() => Array(9).fill(null));
            
            columnNumbers.forEach((nums, col) => {
                const positions = [0,1,2].sort(() => Math.random() - 0.5).slice(0, nums.length);
                positions.forEach((row, idx) => {
                    layout[row][col] = nums[idx];
                });
            });
            
            for (let row = 0; row < 3; row++) {
                for (let col = 0; col < 9; col++) {
                    const cell = document.createElement('button');
                    cell.className = 'board-cell';
                    const num = layout[row][col];
                    
                    if (num) {
                        cell.textContent = num;
                        cell.dataset.number = num;
                        cell.dataset.row = row;
                        cell.dataset.column = col;
                        
                        if (row === 1 && col === 4) {
                            cell.classList.add('center-cell');
                            cell.dataset.center = 'true';
                        }
                        
                        cell.onclick = () => toggleMark(cell, num);
                    } else {
                        cell.classList.add('blank-cell');
                        cell.textContent = '‚úó';
                    }
                    
                    grid.appendChild(cell);
                }
            }
            
            wrapper.appendChild(grid);
            board.appendChild(wrapper);
        }

        // Generate 30 Ball Board
        function generate30BallBoard(type) {
            const board = document.getElementById('gameBoard');
            const wrapper = document.createElement('div');
            wrapper.className = 'board-30-wrapper';
            
            // Column labels
            const labels = document.createElement('div');
            labels.className = 'board-30-labels';
            for (let i = 1; i <= 3; i++) {
                const label = document.createElement('div');
                label.className = 'board-30-label';
                label.textContent = `${(i-1)*10+1}-${i*10}`;
                labels.appendChild(label);
            }
            wrapper.appendChild(labels);
            
            // Board Grid
            const grid = document.createElement('div');
            grid.className = 'board-30';
            
            let nums = new Set();
            while (nums.size < 9) {
                nums.add(Math.floor(Math.random() * 30) + 1);
            }
            const numbers = Array.from(nums).sort((a, b) => a - b);
            
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('button');
                cell.className = 'board-cell';
                cell.textContent = numbers[i];
                cell.dataset.number = numbers[i];
                cell.dataset.index = i;
                
                if (i === 4) {
                    cell.classList.add('center-cell');
                    cell.dataset.center = 'true';
                }
                
                cell.onclick = () => toggleMark(cell, numbers[i]);
                
                grid.appendChild(cell);
            }
            
            wrapper.appendChild(grid);
            board.appendChild(wrapper);
        }

        // Generate Pattern Board
        function generatePatternBoard(type) {
            const board = document.getElementById('gameBoard');
            const wrapper = document.createElement('div');
            wrapper.className = 'board-pattern-wrapper';
            
            // BINGO Labels
            const labels = document.createElement('div');
            labels.className = 'board-pattern-labels';
            'BINGO'.split('').forEach(letter => {
                const label = document.createElement('div');
                label.className = 'board-pattern-label';
                label.textContent = letter;
                labels.appendChild(label);
            });
            wrapper.appendChild(labels);
            
            // Board Grid
            const grid = document.createElement('div');
            grid.className = 'board-pattern';
            
            const columnRanges = [[1,15], [16,30], [31,45], [46,60], [61,75]];
            const columnNumbers = columnRanges.map(range => {
                let nums = new Set();
                while (nums.size < 5) {
                    nums.add(Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0]);
                }
                return Array.from(nums).sort((a, b) => a - b);
            });
            
            // Define pattern cells
            const patternCells = getPatternCells(gameState.currentPattern);
            
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 5; col++) {
                    const cell = document.createElement('button');
                    cell.className = 'board-cell';
                    
                    if (row === 2 && col === 2) {
                        cell.textContent = '‚òÖ';
                        cell.classList.add('center-cell');
                        cell.dataset.center = 'true';
                        cell.onclick = () => {
                            if (!cell.classList.contains('marked')) {
                                cell.classList.add('marked');
                            }
                        };
                    } else {
                        const num = columnNumbers[col][row];
                        cell.textContent = num;
                        cell.dataset.number = num;
                        cell.dataset.row = row;
                        cell.dataset.column = col;
                        
                        if (patternCells.includes(`${row}-${col}`)) {
                            cell.classList.add('pattern-cell');
                        }
                        
                        cell.onclick = () => toggleMark(cell, num);
                    }
                    
                    grid.appendChild(cell);
                }
            }
            
            wrapper.appendChild(grid);
            board.appendChild(wrapper);
        }

        // Generate Coverall Board
        function generateCoverallBoard(type) {
            const board = document.getElementById('gameBoard');
            const wrapper = document.createElement('div');
            wrapper.className = 'board-coverall-wrapper';
            
            // Column labels
            const labels = document.createElement('div');
            labels.className = 'board-coverall-labels';
            for (let i = 1; i <= 9; i++) {
                const label = document.createElement('div');
                label.className = 'board-coverall-label';
                label.textContent = `${(i-1)*10+1}-${i*10}`;
                labels.appendChild(label);
            }
            wrapper.appendChild(labels);
            
            // Board Grid
            const grid = document.createElement('div');
            grid.className = 'board-coverall';
            
            let allNumbers = Array.from({length: 90}, (_, i) => i + 1);
            allNumbers = shuffleArray(allNumbers).slice(0, 45);
            
            for (let i = 0; i < 45; i++) {
                const row = Math.floor(i / 9);
                const col = i % 9;
                const cell = document.createElement('button');
                cell.className = 'board-cell';
                cell.textContent = allNumbers[i];
                cell.dataset.number = allNumbers[i];
                cell.dataset.index = i;
                
                if (row === 2 && col === 4) {
                    cell.classList.add('center-cell');
                    cell.dataset.center = 'true';
                }
                
                cell.onclick = () => toggleMark(cell, allNumbers[i]);
                
                grid.appendChild(cell);
            }
            
            wrapper.appendChild(grid);
            board.appendChild(wrapper);
        }

        // Get pattern cells
        function getPatternCells(pattern) {
            const patterns = {
                'x-pattern': ['0-0', '0-4', '1-1', '1-3', '2-2', '3-1', '3-3', '4-0', '4-4'],
                'frame': ['0-0', '0-1', '0-2', '0-3', '0-4', '4-0', '4-1', '4-2', '4-3', '4-4', '1-0', '2-0', '3-0', '1-4', '2-4', '3-4'],
                'postage-stamp': ['0-0', '0-1', '1-0', '1-1', '3-3', '3-4', '4-3', '4-4'],
                'small-diamond': ['1-2', '2-1', '2-2', '2-3', '3-2']
            };
            return patterns[pattern] || patterns['x-pattern'];
        }

        // Shuffle array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Toggle Mark
        function toggleMark(cell, number) {
            if (!gameState.gameActive) {
                showNotification('·å®·ãã·â≥ ·ä†·àç·â∞·åÄ·àò·à®·àù', false);
                return;
            }
            
            if (!gameState.calledNumbers.includes(number)) {
                showNotification('·ã≠·àÖ ·âÅ·å•·à≠ ·ä†·àç·â∞·å†·à´·àù', false);
                return;
            }
            
            if (cell.classList.contains('marked')) {
                cell.classList.remove('marked');
                gameState.markedNumbers.delete(number);
            } else {
                cell.classList.add('marked');
                gameState.markedNumbers.add(number);
            }
        }

        // Update Called Numbers Display
        function updateCalledNumbersDisplay() {
            const bar = document.getElementById('calledNumbersBar');
            bar.innerHTML = '';
            
            gameState.calledNumbers.forEach(num => {
                const span = document.createElement('span');
                span.className = 'called-number amharic-text';
                span.textContent = num;
                bar.appendChild(span);
            });
            
            if (gameState.calledNumbers.length === 0) {
                bar.innerHTML = '<span style="color: #888; font-style: italic;" class="amharic-text">·âÅ·å•·àÆ·âΩ ·ã≠·å†·à´·àâ...</span>';
            }
        }

        // Announce Win
        function announceWin() {
            if (!gameState.gameActive) {
                showNotification('·å®·ãã·â≥ ·ä†·àç·â∞·åÄ·àò·à®·àù', false);
                return;
            }
            
            const win = calculateWin();
            if (win) {
                const winAmount = calculatePotentialWin(gameState.stake);
                
                // Send win claim to server
                sendMessage({
                    type: 'claim_win',
                    playerName: gameState.playerName,
                    playerId: gameState.playerId,
                    pattern: win.pattern,
                    amount: winAmount
                });
                
                // Show local notification
                document.getElementById('winnerName').textContent = gameState.playerName;
                document.getElementById('winPattern').textContent = gameState.winConditions[win.pattern] || win.pattern;
                document.getElementById('displayWinAmount').textContent = `${winAmount.toLocaleString()} ·â•·à≠`;
                document.getElementById('winnerStatus').textContent = '·â†·àõ·à®·åã·åà·å• ·àã·ã≠...';
                document.getElementById('continueGameBtn').style.display = 'none';
                document.getElementById('winnerNotification').style.display = 'block';
                
                const audio = document.getElementById('winAudio');
                audio.currentTime = 0;
                audio.play().catch(() => {});
            } else {
                showNotification('·ä†·à∏·äì·çä ·äï·ãµ·çç ·ä†·àç·â∞·å†·äì·âÄ·âÄ·àù·ç¢ ·ä•·â£·ä≠·ãé ·ã≠·âÜ·å•·à©!', false);
            }
        }

        // Calculate Win
        function calculateWin() {
            const type = gameState.gameType;
            const patterns = gameState.winningPatterns[type];
            
            for (const pattern of patterns) {
                if (checkPattern(pattern)) {
                    return { pattern: pattern };
                }
            }
            
            return null;
        }

        // Check Specific Pattern
        function checkPattern(pattern) {
            const cells = document.querySelectorAll('.board-cell:not(.blank-cell)');
            const markedCells = Array.from(cells).filter(cell => 
                cell.classList.contains('marked') || 
                (cell.classList.contains('center-cell') && 
                 (gameState.gameType === '75ball' || gameState.gameType === '50ball' || gameState.gameType === 'pattern'))
            );
            
            const markedPositions = new Set();
            markedCells.forEach(cell => {
                if (cell.dataset.row !== undefined && cell.dataset.column !== undefined) {
                    markedPositions.add(`${cell.dataset.row}-${cell.dataset.column}`);
                } else if (cell.dataset.index !== undefined) {
                    markedPositions.add(`i${cell.dataset.index}`);
                }
            });
            
            switch(gameState.gameType) {
                case '75ball':
                case '50ball':
                    return check75BallPattern(pattern, markedPositions);
                case '90ball':
                    return check90BallPattern(pattern, markedPositions);
                case '30ball':
                    return check30BallPattern(pattern, markedPositions);
                case 'pattern':
                    return checkPatternBingo(pattern, markedPositions);
                case 'coverall':
                    return checkCoverallPattern(pattern, markedPositions);
                default:
                    return false;
            }
        }

        // Check 75-Ball Patterns
        function check75BallPattern(pattern, markedPositions) {
            switch(pattern) {
                case 'row':
                    for (let row = 0; row < 5; row++) {
                        let complete = true;
                        for (let col = 0; col < 5; col++) {
                            const pos = `${row}-${col}`;
                            if (row === 2 && col === 2) continue;
                            if (!markedPositions.has(pos)) {
                                complete = false;
                                break;
                            }
                        }
                        if (complete) return true;
                    }
                    return false;
                    
                case 'column':
                    for (let col = 0; col < 5; col++) {
                        let complete = true;
                        for (let row = 0; row < 5; row++) {
                            const pos = `${row}-${col}`;
                            if (row === 2 && col === 2) continue;
                            if (!markedPositions.has(pos)) {
                                complete = false;
                                break;
                            }
                        }
                        if (complete) return true;
                    }
                    return false;
                    
                case 'diagonal':
                    let diag1Complete = true;
                    for (let i = 0; i < 5; i++) {
                        const pos = `${i}-${i}`;
                        if (i === 2) continue;
                        if (!markedPositions.has(pos)) {
                            diag1Complete = false;
                            break;
                        }
                    }
                    if (diag1Complete) return true;
                    
                    let diag2Complete = true;
                    for (let i = 0; i < 5; i++) {
                        const pos = `${i}-${4-i}`;
                        if (i === 2) continue;
                        if (!markedPositions.has(pos)) {
                            diag2Complete = false;
                            break;
                        }
                    }
                    return diag2Complete;
                    
                case 'four-corners':
                    const corners = ['0-0', '0-4', '4-0', '4-4'];
                    return corners.every(pos => markedPositions.has(pos));
                    
                case 'full-house':
                    for (let row = 0; row < 5; row++) {
                        for (let col = 0; col < 5; col++) {
                            if (row === 2 && col === 2) continue;
                            const pos = `${row}-${col}`;
                            if (!markedPositions.has(pos)) {
                                return false;
                            }
                        }
                    }
                    return true;
                    
                default:
                    return false;
            }
        }

        // Check 90-Ball Patterns
        function check90BallPattern(pattern, markedPositions) {
            const rowCounts = [0, 0, 0];
            const totalCells = 15;
            
            const markedCells = Array.from(document.querySelectorAll('.board-cell:not(.blank-cell)')).filter(cell => 
                cell.classList.contains('marked')
            );
            
            markedCells.forEach(cell => {
                if (cell.dataset.row !== undefined) {
                    const row = parseInt(cell.dataset.row);
                    if (row >= 0 && row < 3) {
                        rowCounts[row]++;
                    }
                }
            });
            
            switch(pattern) {
                case 'one-line':
                    return rowCounts.some(count => count >= 5);
                    
                case 'two-lines':
                    const rowsWithAllNumbers = rowCounts.filter(count => count >= 5);
                    return rowsWithAllNumbers.length >= 2;
                    
                case 'full-house':
                    return markedCells.length >= totalCells;
                    
                default:
                    return false;
            }
        }

        // Check 30-Ball Pattern
        function check30BallPattern(pattern, markedPositions) {
            if (pattern === 'full-house') {
                return markedPositions.size >= 9;
            }
            return false;
        }

        // Check Pattern Bingo
        function checkPatternBingo(pattern, markedPositions) {
            const patternCells = getPatternCells(pattern);
            return patternCells.every(pos => markedPositions.has(pos));
        }

        // Check Coverall Pattern
        function checkCoverallPattern(pattern, markedPositions) {
            if (pattern === 'full-board') {
                return markedPositions.size >= 45;
            }
            return false;
        }

        // Continue Game
        function continueGame() {
            document.getElementById('winnerNotification').style.display = 'none';
        }

        // Update Finance
        function updateFinance() {
            const balance = gameState.payment + gameState.totalWon - gameState.totalWithdrawn;
            const withdraw = Math.floor(balance * 0.97);
            
            document.getElementById('totalPayment').value = `${gameState.payment} ·â•·à≠`;
            document.getElementById('totalWon').value = `${gameState.totalWon.toLocaleString()} ·â•·à≠`;
            document.getElementById('currentBalance').value = `${balance.toLocaleString()} ·â•·à≠`;
            document.getElementById('withdrawAmount').value = `${withdraw.toLocaleString()} ·â•·à≠`;
        }

        // Process Withdrawal
        function processWithdrawal() {
            const account = document.getElementById('withdrawAccount').value;
            const amount = parseInt(document.getElementById('withdrawAmount').value.replace(/,/g, ''));
            
            if (!account) {
                showNotification('·ã®·ä†·ä´·ãç·äï·âµ ·âÅ·å•·à≠ ·ã´·àµ·åà·â°', false);
                return;
            }
            
            if (amount < 25) {
                showNotification('·ãù·âÖ·â∞·äõ ·àò·å†·äï 25 ·â•·à≠', false);
                return;
            }
            
            const balance = gameState.payment + gameState.totalWon - gameState.totalWithdrawn;
            if (amount > balance) {
                showNotification('·â†·âÇ ·àö·ãõ·äï ·ã®·àà·àù', false);
                return;
            }
            
            gameState.totalWithdrawn += amount;
            updateFinance();
            showNotification(`${amount.toLocaleString()} ·â•·à≠ ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·ãà·åç·ã∑·àç!`, false);
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
        
        // Mobile compatibility
        document.addEventListener('touchstart', (e) => {
            if (e.touches.length > 1) e.preventDefault();
        }, { passive: false });
        
        document.addEventListener('gesturestart', (e) => e.preventDefault());
        document.addEventListener('contextmenu', (e) => e.preventDefault());
        
        // Handle orientation change
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                window.scrollTo(0, 0);
                if (gameState.gameType) {
                    generateGameBoard();
                }
            }, 100);
        });
        
        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            const membersModal = document.getElementById('membersModal');
            const potentialWinModal = document.getElementById('potentialWinModal');
            
            if (e.target === membersModal) {
                membersModal.style.display = 'none';
            }
            if (e.target === potentialWinModal) {
                potentialWinModal.style.display = 'none';
            }
        });
        
        // Ensure boards fit on resize
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                if (gameState.gameType) {
                    generateGameBoard();
                }
            }, 250);
        });
    </script>
</body>
</html>